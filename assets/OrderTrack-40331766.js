import{_ as ie,r as v,a as $,o as ue,b as de,c as r,n as ce,d as m,e as x,f as t,w as l,E as h,F as O,p as z,i as n,g as p,t as s,q as pe,h as V,j,l as me}from"./index-bbf05c48.js";const _e={class:"order-track"},ve={class:"card-header"},fe={class:"pagination"},ge={class:"progress-section"},ye={class:"items-section"},be={class:"delivery-section"},ke={class:"logistics-timeline"},he={__name:"OrderTrack",setup(Ve){const y=v(!1),M=v(!1),S=v(!1),b=v(!0),i=v({}),C=v({}),d=$({orderNo:"",status:"",dateRange:[]}),_=$({currentPage:1,pageSize:10,total:0}),B=v([]),A=[{label:"已提交",value:"submitted"},{label:"已接单",value:"accepted"},{label:"备货中",value:"preparing"},{label:"已发货",value:"delivered"},{label:"已完成",value:"completed"}],R=o=>({product:"",rental:"success",service:"warning"})[o]||"",U=o=>({product:"商品购买",rental:"设备租赁",service:"服务订单"})[o]||o,X=o=>({submitted:"info",accepted:"warning",preparing:"warning",delivered:"success",completed:"success"})[o]||"",P=o=>({submitted:"已提交",accepted:"已接单",preparing:"备货中",delivered:"已发货",completed:"已完成"})[o]||o,E=()=>{k()},G=()=>{Object.keys(d).forEach(o=>{d[o]=""}),d.dateRange=[],E()},H=o=>{_.pageSize=o,k()},J=o=>{_.currentPage=o,k()},K=o=>{i.value=o,M.value=!0},Q=o=>{C.value={company:"示例物流",trackingNo:"SF1234567890",tracks:[{time:"2024-01-15 14:30:00",content:"快件已签收，签收人：张三"},{time:"2024-01-15 09:30:00",content:"快件已到达【北京朝阳区营业点】"},{time:"2024-01-14 20:30:00",content:"快件已从【上海转运中心】发出"}]},S.value=!0},W=o=>{me.confirm("确认已收到商品？","确认收货",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{y.value=!0;try{await new Promise(a=>setTimeout(a,1e3)),h.success("确认收货成功"),k()}catch{h.error("操作失败")}finally{y.value=!1}})},Z=()=>{b.value=!b.value,h.success(b.value?"已开启通知":"已关闭通知")},k=async()=>{y.value=!0;try{await new Promise(o=>setTimeout(o,1e3)),B.value=[{orderNo:"ORD202401150001",createTime:"2024-01-15 14:30:00",type:"product",status:"delivered",amount:29999,paymentMethod:"在线支付",progress:[{time:"2024-01-15 14:30:00",content:"商品已发货",type:"success"},{time:"2024-01-14 10:00:00",content:"订单已确认",type:"success"},{time:"2024-01-14 09:30:00",content:"订单已提交",type:"success"}],items:[{name:"无人机A型",quantity:1,price:29999}],delivery:{contact:"张三",phone:"13800138000",address:"上海市浦东新区XX路XX号"},logistics:!0},{orderNo:"ORD202401150002",createTime:"2024-01-15 10:00:00",type:"rental",status:"preparing",amount:1999,paymentMethod:"在线支付",progress:[{time:"2024-01-15 10:00:00",content:"订单已确认",type:"success"},{time:"2024-01-15 09:30:00",content:"订单已提交",type:"success"}],items:[{name:"专业航拍无人机",quantity:1,price:1999}],delivery:{contact:"李四",phone:"13900139000",address:"北京市朝阳区XX路XX号"}}],_.total=20}catch{h.error("加载数据失败")}finally{y.value=!1}};let N=null;const ee=async()=>{if(b.value)try{h({message:"订单 ORD202401150001 已发货",type:"success"})}catch(o){console.error("检查订单状态失败:",o)}};return ue(()=>{k(),N=setInterval(ee,3e4)}),de(()=>{N&&clearInterval(N)}),(o,a)=>{const te=r("el-input"),T=r("el-form-item"),le=r("el-option"),ae=r("el-select"),oe=r("el-date-picker"),f=r("el-button"),ne=r("el-form"),q=r("el-card"),c=r("el-table-column"),w=r("el-tag"),F=r("el-table"),se=r("el-pagination"),u=r("el-descriptions-item"),D=r("el-descriptions"),L=r("el-timeline-item"),Y=r("el-timeline"),I=r("el-dialog"),re=ce("loading");return m(),x("div",_e,[t(q,{class:"filter-card"},{default:l(()=>[t(ne,{inline:!0,model:d,class:"search-form"},{default:l(()=>[t(T,{label:"订单编号"},{default:l(()=>[t(te,{modelValue:d.orderNo,"onUpdate:modelValue":a[0]||(a[0]=e=>d.orderNo=e),placeholder:"请输入订单编号",clearable:""},null,8,["modelValue"])]),_:1}),t(T,{label:"订单状态"},{default:l(()=>[t(ae,{modelValue:d.status,"onUpdate:modelValue":a[1]||(a[1]=e=>d.status=e),placeholder:"请选择",clearable:""},{default:l(()=>[(m(),x(O,null,z(A,e=>t(le,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(T,{label:"下单时间"},{default:l(()=>[t(oe,{modelValue:d.dateRange,"onUpdate:modelValue":a[2]||(a[2]=e=>d.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(T,null,{default:l(()=>[t(f,{type:"primary",onClick:E},{default:l(()=>a[7]||(a[7]=[n("搜索")])),_:1}),t(f,{onClick:G},{default:l(()=>a[8]||(a[8]=[n("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(q,{class:"list-card"},{header:l(()=>[p("div",ve,[a[9]||(a[9]=p("h2",null,"订单跟踪",-1)),t(f,{type:"primary",onClick:Z},{default:l(()=>[n(s(b.value?"关闭通知":"开启通知"),1)]),_:1})])]),default:l(()=>[pe((m(),V(F,{data:B.value,style:{width:"100%"}},{default:l(()=>[t(c,{prop:"orderNo",label:"订单编号",width:"180"}),t(c,{prop:"createTime",label:"下单时间",width:"180",sortable:""}),t(c,{prop:"type",label:"订单类型",width:"120"},{default:l(({row:e})=>[t(w,{type:R(e.type)},{default:l(()=>[n(s(U(e.type)),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"status",label:"订单状态",width:"120"},{default:l(({row:e})=>[t(w,{type:X(e.status)},{default:l(()=>[n(s(P(e.status)),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"amount",label:"订单金额",width:"120"},{default:l(({row:e})=>[n(" ¥"+s(e.amount),1)]),_:1}),t(c,{label:"操作",width:"200",fixed:"right"},{default:l(({row:e})=>[t(f,{link:"",type:"primary",onClick:g=>K(e)},{default:l(()=>a[10]||(a[10]=[n("详情")])),_:2},1032,["onClick"]),e.status==="delivered"?(m(),V(f,{key:0,link:"",type:"success",onClick:g=>W(e)},{default:l(()=>a[11]||(a[11]=[n(" 确认收货 ")])),_:2},1032,["onClick"])):j("",!0),e.logistics?(m(),V(f,{key:1,link:"",type:"primary",onClick:g=>Q(e)},{default:l(()=>a[12]||(a[12]=[n(" 物流信息 ")])),_:2},1032,["onClick"])):j("",!0)]),_:1})]),_:1},8,["data"])),[[re,y.value]]),p("div",fe,[t(se,{"current-page":_.currentPage,"onUpdate:currentPage":a[3]||(a[3]=e=>_.currentPage=e),"page-size":_.pageSize,"onUpdate:pageSize":a[4]||(a[4]=e=>_.pageSize=e),"page-sizes":[10,20,50,100],total:_.total,layout:"total, sizes, prev, pager, next",onSizeChange:H,onCurrentChange:J},null,8,["current-page","page-size","total"])])]),_:1}),t(I,{modelValue:M.value,"onUpdate:modelValue":a[5]||(a[5]=e=>M.value=e),title:"订单详情",width:"60%"},{default:l(()=>[t(D,{column:2,border:""},{default:l(()=>[t(u,{label:"订单编号"},{default:l(()=>[n(s(i.value.orderNo),1)]),_:1}),t(u,{label:"下单时间"},{default:l(()=>[n(s(i.value.createTime),1)]),_:1}),t(u,{label:"订单类型"},{default:l(()=>[t(w,{type:R(i.value.type)},{default:l(()=>[n(s(U(i.value.type)),1)]),_:1},8,["type"])]),_:1}),t(u,{label:"订单状态"},{default:l(()=>[t(w,{type:X(i.value.status)},{default:l(()=>[n(s(P(i.value.status)),1)]),_:1},8,["type"])]),_:1}),t(u,{label:"订单金额"},{default:l(()=>[n("¥"+s(i.value.amount),1)]),_:1}),t(u,{label:"支付方式"},{default:l(()=>[n(s(i.value.paymentMethod),1)]),_:1})]),_:1}),p("div",ge,[a[13]||(a[13]=p("h4",null,"订单进度",-1)),t(Y,null,{default:l(()=>[(m(!0),x(O,null,z(i.value.progress,(e,g)=>(m(),V(L,{key:g,timestamp:e.time,type:e.type},{default:l(()=>[n(s(e.content),1)]),_:2},1032,["timestamp","type"]))),128))]),_:1})]),p("div",ye,[a[14]||(a[14]=p("h4",null,"商品信息",-1)),t(F,{data:i.value.items,border:""},{default:l(()=>[t(c,{prop:"name",label:"商品名称"}),t(c,{prop:"quantity",label:"数量",width:"120"}),t(c,{prop:"price",label:"单价",width:"120"},{default:l(({row:e})=>[n("¥"+s(e.price),1)]),_:1}),t(c,{prop:"total",label:"小计",width:"120"},{default:l(({row:e})=>[n("¥"+s(e.price*e.quantity),1)]),_:1})]),_:1},8,["data"])]),p("div",be,[a[15]||(a[15]=p("h4",null,"收货信息",-1)),t(D,{column:1,border:""},{default:l(()=>[t(u,{label:"收货人"},{default:l(()=>{var e;return[n(s((e=i.value.delivery)==null?void 0:e.contact),1)]}),_:1}),t(u,{label:"联系电话"},{default:l(()=>{var e;return[n(s((e=i.value.delivery)==null?void 0:e.phone),1)]}),_:1}),t(u,{label:"收货地址"},{default:l(()=>{var e;return[n(s((e=i.value.delivery)==null?void 0:e.address),1)]}),_:1})]),_:1})])]),_:1},8,["modelValue"]),t(I,{modelValue:S.value,"onUpdate:modelValue":a[6]||(a[6]=e=>S.value=e),title:"物流信息",width:"50%"},{default:l(()=>[t(D,{column:1,border:""},{default:l(()=>[t(u,{label:"物流公司"},{default:l(()=>[n(s(C.value.company),1)]),_:1}),t(u,{label:"物流单号"},{default:l(()=>[n(s(C.value.trackingNo),1)]),_:1})]),_:1}),p("div",ke,[t(Y,null,{default:l(()=>[(m(!0),x(O,null,z(C.value.tracks,(e,g)=>(m(),V(L,{key:g,timestamp:e.time},{default:l(()=>[n(s(e.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})])]),_:1},8,["modelValue"])])}}},Te=ie(he,[["__scopeId","data-v-149f82aa"]]);export{Te as default};
