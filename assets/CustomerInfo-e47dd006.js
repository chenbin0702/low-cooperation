import{_ as de,a as q,r as m,o as re,c as u,n as se,d as c,e as x,f as l,w as o,E as w,i as s,g as f,q as ie,h as z,t as E,F as I,p as O,l as pe}from"./index-bbf05c48.js";const me={class:"customer-info"},fe={class:"card-header"},ve={class:"pagination"},be={class:"dialog-footer"},ge={class:"tags-container"},_e={class:"current-tags"},ce={class:"add-tag"},Ve={__name:"CustomerInfo",setup(ye){const i=q({name:"",phone:"",field:"",source:""}),v=q({currentPage:1,pageSize:10,total:0}),j=m([]),V=m(!1),C=m(!1),L=m("add"),P=m("basic"),S=m(null),t=q({name:"",phone:"",company:"",position:"",field:"",budget:"",intentionLevel:0,sourceType:"online",sourcePlatform:"",remark:""}),J={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],company:[{required:!0,message:"请输入公司名称",trigger:"blur"}],field:[{required:!0,message:"请选择应用领域",trigger:"change"}]},D=m(!1),y=m([]),B=m(""),K=m(["重要客户","待跟进","已成交","高意向","低意向"]),F=()=>{k()},Q=()=>{Object.keys(i).forEach(n=>{i[n]=""}),F()},W=n=>{v.pageSize=n,k()},X=n=>{v.currentPage=n,k()},M=(n,e=null)=>{L.value=n,C.value=!0,P.value="basic",n==="edit"&&e?Object.assign(t,e):(Object.keys(t).forEach(p=>{t[p]=""}),t.intentionLevel=0,t.sourceType="online")},Y=n=>{y.value=[...n.tags],D.value=!0},Z=n=>{n&&!y.value.includes(n)&&y.value.push(n),B.value=""},h=n=>{const e=y.value.indexOf(n);e>-1&&y.value.splice(e,1)},ee=async()=>{if(S.value)try{await S.value.validate(),V.value=!0,await new Promise(n=>setTimeout(n,1e3)),w.success(L.value==="add"?"添加成功":"更新成功"),C.value=!1,k()}catch{w.error("表单验证失败，请检查必填项")}finally{V.value=!1}},le=n=>{pe.confirm("确定要删除该客户信息吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{V.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),w.success("删除成功"),k()}catch{w.error("删除失败")}finally{V.value=!1}})},k=async()=>{V.value=!0;try{await new Promise(n=>setTimeout(n,1e3)),j.value=[{id:1,name:"张三",phone:"13800138000",company:"某科技公司",position:"总经理",field:"航拍",intentionLevel:3,tags:["重要客户","已成交"]},{id:2,name:"李四",phone:"13900139000",company:"某农业公司",position:"技术总监",field:"植保",intentionLevel:2,tags:["待跟进"]}],v.total=20}catch{w.error("加载数据失败")}finally{V.value=!1}};return re(()=>{k()}),(n,e)=>{const p=u("el-input"),d=u("el-form-item"),r=u("el-option"),U=u("el-select"),b=u("el-button"),N=u("el-form"),R=u("el-card"),g=u("el-table-column"),$=u("el-tag"),A=u("el-rate"),ae=u("el-table"),oe=u("el-pagination"),T=u("el-tab-pane"),G=u("el-radio"),te=u("el-radio-group"),ne=u("el-tabs"),H=u("el-dialog"),ue=se("loading");return c(),x("div",me,[l(R,{class:"search-card"},{default:o(()=>[l(N,{inline:!0,model:i,class:"search-form"},{default:o(()=>[l(d,{label:"客户名称"},{default:o(()=>[l(p,{modelValue:i.name,"onUpdate:modelValue":e[0]||(e[0]=a=>i.name=a),placeholder:"请输入客户名称",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"联系电话"},{default:o(()=>[l(p,{modelValue:i.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>i.phone=a),placeholder:"请输入联系电话",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{label:"应用领域"},{default:o(()=>[l(U,{modelValue:i.field,"onUpdate:modelValue":e[2]||(e[2]=a=>i.field=a),placeholder:"请选择",clearable:""},{default:o(()=>[l(r,{label:"航拍",value:"aerial"}),l(r,{label:"测绘",value:"mapping"}),l(r,{label:"植保",value:"protection"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"来源渠道"},{default:o(()=>[l(U,{modelValue:i.source,"onUpdate:modelValue":e[3]||(e[3]=a=>i.source=a),placeholder:"请选择",clearable:""},{default:o(()=>[l(r,{label:"线上",value:"online"}),l(r,{label:"线下",value:"offline"})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(b,{type:"primary",onClick:F},{default:o(()=>e[22]||(e[22]=[s("搜索")])),_:1}),l(b,{onClick:Q},{default:o(()=>e[23]||(e[23]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(R,{class:"list-card"},{header:o(()=>[f("div",fe,[e[25]||(e[25]=f("h2",null,"客户信息列表",-1)),l(b,{type:"primary",onClick:e[4]||(e[4]=a=>M("add"))},{default:o(()=>e[24]||(e[24]=[s("新增客户")])),_:1})])]),default:o(()=>[ie((c(),z(ae,{data:j.value,style:{width:"100%"}},{default:o(()=>[l(g,{prop:"name",label:"姓名"}),l(g,{prop:"phone",label:"联系电话"}),l(g,{prop:"company",label:"公司"}),l(g,{prop:"position",label:"职位"}),l(g,{prop:"field",label:"应用领域"},{default:o(({row:a})=>[l($,null,{default:o(()=>[s(E(a.field),1)]),_:2},1024)]),_:1}),l(g,{prop:"intentionLevel",label:"意向级别"},{default:o(({row:a})=>[l(A,{modelValue:a.intentionLevel,"onUpdate:modelValue":_=>a.intentionLevel=_,disabled:"",max:3},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(g,{label:"标签"},{default:o(({row:a})=>[(c(!0),x(I,null,O(a.tags,_=>(c(),z($,{key:_,class:"mx-1",size:"small"},{default:o(()=>[s(E(_),1)]),_:2},1024))),128))]),_:1}),l(g,{label:"操作",width:"200"},{default:o(({row:a})=>[l(b,{link:"",type:"primary",onClick:_=>M("edit",a)},{default:o(()=>e[26]||(e[26]=[s("编辑")])),_:2},1032,["onClick"]),l(b,{link:"",type:"primary",onClick:_=>Y(a)},{default:o(()=>e[27]||(e[27]=[s("标签")])),_:2},1032,["onClick"]),l(b,{link:"",type:"danger",onClick:_=>le(a)},{default:o(()=>e[28]||(e[28]=[s("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ue,V.value]]),f("div",ve,[l(oe,{"current-page":v.currentPage,"onUpdate:currentPage":e[5]||(e[5]=a=>v.currentPage=a),"page-size":v.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>v.pageSize=a),"page-sizes":[10,20,50,100],total:v.total,layout:"total, sizes, prev, pager, next",onSizeChange:W,onCurrentChange:X},null,8,["current-page","page-size","total"])])]),_:1}),l(H,{modelValue:C.value,"onUpdate:modelValue":e[19]||(e[19]=a=>C.value=a),title:L.value==="add"?"新增客户":"编辑客户",width:"60%"},{footer:o(()=>[f("span",be,[l(b,{onClick:e[18]||(e[18]=a=>C.value=!1)},{default:o(()=>e[31]||(e[31]=[s("取消")])),_:1}),l(b,{type:"primary",onClick:ee},{default:o(()=>e[32]||(e[32]=[s("确定")])),_:1})])]),default:o(()=>[l(N,{ref_key:"formRef",ref:S,model:t,rules:J,"label-width":"100px"},{default:o(()=>[l(ne,{modelValue:P.value,"onUpdate:modelValue":e[17]||(e[17]=a=>P.value=a)},{default:o(()=>[l(T,{label:"基础信息",name:"basic"},{default:o(()=>[l(d,{label:"姓名",prop:"name"},{default:o(()=>[l(p,{modelValue:t.name,"onUpdate:modelValue":e[7]||(e[7]=a=>t.name=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"联系电话",prop:"phone"},{default:o(()=>[l(p,{modelValue:t.phone,"onUpdate:modelValue":e[8]||(e[8]=a=>t.phone=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"公司",prop:"company"},{default:o(()=>[l(p,{modelValue:t.company,"onUpdate:modelValue":e[9]||(e[9]=a=>t.company=a)},null,8,["modelValue"])]),_:1}),l(d,{label:"职位",prop:"position"},{default:o(()=>[l(p,{modelValue:t.position,"onUpdate:modelValue":e[10]||(e[10]=a=>t.position=a)},null,8,["modelValue"])]),_:1})]),_:1}),l(T,{label:"需求信息",name:"requirement"},{default:o(()=>[l(d,{label:"应用领域",prop:"field"},{default:o(()=>[l(U,{modelValue:t.field,"onUpdate:modelValue":e[11]||(e[11]=a=>t.field=a),style:{width:"100%"}},{default:o(()=>[l(r,{label:"航拍",value:"aerial"}),l(r,{label:"测绘",value:"mapping"}),l(r,{label:"植保",value:"protection"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"预算范围",prop:"budget"},{default:o(()=>[l(U,{modelValue:t.budget,"onUpdate:modelValue":e[12]||(e[12]=a=>t.budget=a),style:{width:"100%"}},{default:o(()=>[l(r,{label:"10万以下",value:"<100k"}),l(r,{label:"10-50万",value:"100k-500k"}),l(r,{label:"50-100万",value:"500k-1m"}),l(r,{label:"100万以上",value:">1m"})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"意向级别",prop:"intentionLevel"},{default:o(()=>[l(A,{modelValue:t.intentionLevel,"onUpdate:modelValue":e[13]||(e[13]=a=>t.intentionLevel=a),max:3},null,8,["modelValue"])]),_:1})]),_:1}),l(T,{label:"来源信息",name:"source"},{default:o(()=>[l(d,{label:"来源类型",prop:"sourceType"},{default:o(()=>[l(te,{modelValue:t.sourceType,"onUpdate:modelValue":e[14]||(e[14]=a=>t.sourceType=a)},{default:o(()=>[l(G,{label:"online"},{default:o(()=>e[29]||(e[29]=[s("线上")])),_:1}),l(G,{label:"offline"},{default:o(()=>e[30]||(e[30]=[s("线下")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"来源平台",prop:"sourcePlatform"},{default:o(()=>[l(p,{modelValue:t.sourcePlatform,"onUpdate:modelValue":e[15]||(e[15]=a=>t.sourcePlatform=a)},null,8,["modelValue"])]),_:1})]),_:1}),l(T,{label:"备注信息",name:"remark"},{default:o(()=>[l(d,{label:"备注",prop:"remark"},{default:o(()=>[l(p,{modelValue:t.remark,"onUpdate:modelValue":e[16]||(e[16]=a=>t.remark=a),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(H,{modelValue:D.value,"onUpdate:modelValue":e[21]||(e[21]=a=>D.value=a),title:"标签管理",width:"30%"},{default:o(()=>[f("div",ge,[f("div",_e,[e[33]||(e[33]=f("h4",null,"已有标签",-1)),(c(!0),x(I,null,O(y.value,a=>(c(),z($,{key:a,closable:"",onClose:_=>h(a),class:"mx-1"},{default:o(()=>[s(E(a),1)]),_:2},1032,["onClose"]))),128))]),f("div",ce,[e[34]||(e[34]=f("h4",null,"添加标签",-1)),l(U,{modelValue:B.value,"onUpdate:modelValue":e[20]||(e[20]=a=>B.value=a),filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择或输入标签",onChange:Z},{default:o(()=>[(c(!0),x(I,null,O(K.value,a=>(c(),z(r,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue"])])}}},Ce=de(Ve,[["__scopeId","data-v-f28a335e"]]);export{Ce as default};
